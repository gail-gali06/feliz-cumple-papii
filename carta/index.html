<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Feliz Cumplea√±os Pap√° üíå</title>
<style>
:root {
  --verde: #c8f2d1;
  --azul: #cce3ff;
  --fondo-entrada: url('papa.jpg');
}

* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: "Inter", system-ui, -apple-system, 'Segoe UI', Roboto;
  min-height: 100vh;
  background: url('papa.jpg') center/cover no-repeat;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #111;
  overflow: hidden;
}

/* ENTRADA */
#entrada {
  position: fixed; inset: 0;
  background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), var(--fondo-entrada);
  background-size: cover; background-position: center;
  display: flex; align-items: center; justify-content: center; flex-direction: column;
  z-index: 30;
}
#entrada .copy {
  background: rgba(255,255,255,0.95);
  color: #111; padding: 16px 22px; border-radius: 14px;
  text-align: center; max-width: 92%;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}
#entrada h1 { font-size: 1.3rem; margin-bottom: 10px; }
#entrarBtn {
  margin-top: 12px; background: linear-gradient(90deg, var(--verde), var(--azul));
  border: none; padding: 12px 20px; border-radius: 12px;
  font-weight: 800; cursor: pointer; color: #123;
}

/* STAGE */
.stage { width: 100%; max-width: 420px; padding: 18px; display: flex; flex-direction: column; align-items: center; gap: 14px; }

/* SOBRE */
.envelope {
  width: 340px; height: 220px; position: relative; perspective: 1000px;
}
.envelope .body {
  position: absolute; left: 0; bottom: 0; width: 100%; height: 86%;
  background: linear-gradient(135deg, var(--azul), var(--verde));
  border-radius: 12px; box-shadow: 0 14px 30px rgba(0,0,0,0.35);
}
.flap {
  position: absolute; left: 0; top: 0; width: 100%; height: 70%;
  background: linear-gradient(135deg, var(--verde), var(--azul));
  border-radius: 12px 12px 6px 6px;
  transform-origin: 50% 100%;
  transform: rotateX(0deg);
  transition: transform 700ms cubic-bezier(.2,.9,.2,1);
  display: flex; align-items: center; justify-content: center;
  color: #123; font-weight: 800; font-size: 1rem;
  box-shadow: 0 10px 20px rgba(0,0,0,0.18);
}
.envelope.open .flap { transform: rotateX(-160deg); }

/* CARTAS */
.stack {
  position: absolute; left: 50%; top: 20%; transform: translateX(-50%);
  width: 86%; height: 60%;
  overflow: hidden; display: flex; align-items: center; justify-content: center;
}
.card {
  position: absolute; width: 100%; height: 100%;
  background: linear-gradient(180deg,#fff,#fbfbff);
  border-radius: 10px; padding: 14px;
  box-shadow: 0 8px 18px rgba(0,0,0,0.18);
  opacity: 0; transform: translateX(100%) scale(0.98);
  transition: transform 0.6s ease, opacity 0.6s ease;
  display: flex; flex-direction: column;
}
.card.visible {
  opacity: 1;
  transform: translateX(0) scale(1);
}
.card.exit-left {
  opacity: 0;
  transform: translateX(-100%) scale(0.98);
}
.card h2 { margin: 0 0 8px 0; font-size: 1.05rem; color: #036; }
.card p { margin: 0; font-size: 0.95rem; color: #222; white-space: pre-wrap; }

/* PART√çCULAS */
.particle {
  position: fixed; pointer-events: none; z-index: 20; opacity: 1;
}
.heart {
  width: 18px; height: 18px;
  background: linear-gradient(180deg,#ff5c8d,#ff2a68);
  clip-path: polygon(50% 15%,61% 24%,71% 28%,78% 33%,82% 39%,86% 49%,86% 59%,78% 69%,66% 78%,50% 90%,34% 78%,22% 69%,14% 59%,14% 49%,18% 39%,22% 33%,29% 28%,39% 24%);
  border-radius: 3px;
}
.conf {
  width: 10px; height: 14px; border-radius: 2px;
}
@keyframes fall { to { transform: translateY(120vh) rotate(720deg); opacity: 0; } }

@media(max-width:420px){
  .envelope{width:90%;height:210px;}
  .card h2{font-size:1rem;}
  .card p{font-size:0.92rem;}
}
</style>
</head>
<body>
  <!-- ENTRADA -->
  <div id="entrada">
    <div class="copy">
      <h1>HAPPY BIRTHDAY DADDY I LOVE YOU SO MUCH ‚ù§Ô∏è</h1>
      <p>Presiona <strong>Entrar</strong> para ver la sorpresa.</p>
      <button id="entrarBtn">Entrar üíå</button>
    </div>
  </div>

  <!-- ESCENA PRINCIPAL -->
  <div class="stage" style="display:none;">
    <div class="envelope closed" id="envelope">
      <div class="flap" id="flap">Toca aqu√≠ para abrir</div>
      <div class="body"></div>
      <div class="stack" id="stack"></div>
    </div>
  </div>

  <audio id="audio" loop>
    <source src="papa.mp3" type="audio/mpeg">
  </audio>

<script>
const messages = [
  { title: 'Te amo pap√°', body: 'Feliz cumplea√±os, pap√°. Gracias por tu amor infinito y tus ense√±anzas.\nEres mi fuerza.' },
  { title: 'Gracias por todo', body: 'Gracias por los sacrificios, por cuidarme y por creer siempre en m√≠.\nTe quiero mucho.' },
  { title: 'Eres mi h√©roe', body: 'Hoy celebro tu vida. Que este a√±o venga lleno de salud, paz y alegr√≠as.\n¬°Feliz d√≠a!' }
];

const entrada = document.getElementById('entrada');
const entrarBtn = document.getElementById('entrarBtn');
const stage = document.querySelector('.stage');
const envelope = document.getElementById('envelope');
const flap = document.getElementById('flap');
const stack = document.getElementById('stack');
const audio = document.getElementById('audio');

let idx = 0;
let opened = false;

function escapeHtml(s) {
  return String(s)
    .replaceAll('&','&amp;')
    .replaceAll('<','&lt;')
    .replaceAll('>','&gt;')
    .replaceAll('\n','<br>');
}

function renderStack() {
  stack.innerHTML = '';
  messages.forEach((m,i)=>{
    const el = document.createElement('div');
    el.className = 'card';
    if(i===0) el.classList.add('visible');
    el.innerHTML = `<h2>${escapeHtml(m.title)}</h2><p>${escapeHtml(m.body)}</p>`;
    stack.appendChild(el);
  });
}

entrarBtn.addEventListener('click', ()=>{
  entrada.style.display = 'none';
  stage.style.display = 'flex';
  renderStack();

  // Iniciar m√∫sica (permitido porque es una acci√≥n de usuario)
  audio.currentTime = 0;
  audio.play().catch(()=>{});
});

// Abrir sobre
flap.addEventListener('click', ()=>{
  if(opened) return;
  envelope.classList.add('open');
  opened = true;
  burstParticles();
});

// Deslizar cartas con touch
let startX = 0;
stack.addEventListener('touchstart', e => startX = e.touches[0].clientX);
stack.addEventListener('touchend', e => {
  const diff = e.changedTouches[0].clientX - startX;
  if (Math.abs(diff) > 50) {
    const cards = stack.querySelectorAll('.card');
    cards[idx].classList.remove('visible');
    cards[idx].classList.add(diff>0 ? 'exit-right':'exit-left');
    idx = (idx + (diff>0 ? -1 : 1) + messages.length) % messages.length;
    cards[idx].classList.add('visible');
  }
});

// Part√≠culas corazones/confetti
function burstParticles(){
  for(let i=0;i<14;i++) createParticle(Math.random()<0.5? 'heart':'conf');
}
function createParticle(type){
  const el = document.createElement('div');
  el.className = 'particle ' + (type==='heart'?'heart':'conf');
  el.style.left = Math.random()*80 + 10 + 'vw';
  el.style.top = (Math.random()*10 + 5) + 'vh';
  el.style.transform = `translateY(0) rotate(${Math.random()*360}deg)`;
  el.style.animation = `fall ${2 + Math.random()*2}s linear forwards`;
  if(type==='conf') el.style.background = ['#ffcc00','#ff6699','#66ccff','#99ff66'][Math.floor(Math.random()*4)];
  document.body.appendChild(el);
  setTimeout(()=>el.remove(),3500);
}
</script>
</body>
</html>
